<!DOCTYPE html>
<html>
<head>
    <title>Sending Messages...</title>
</head>
<body>
    <h2>Sending WhatsApp Messages</h2>
    <p id="status">Starting...</p>

    <script>
        const sessionId = "{{ session_id }}";

        function checkProgress() {
            fetch(`/progress/${sessionId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.done) {
                        document.getElementById("status").innerText = 
                            `âœ… Done! Sent to ${data.sent} numbers.`;
                    } else {
                        document.getElementById("status").innerText = 
                            `Sending... ${data.sent} / ${data.total} (${data.percent}%)`;
                        setTimeout(checkProgress, 1500);
                    }
                });
        }

        checkProgress();
    </script>
</body>
</html>
